<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Theme Preview: <%= @brand_setting.name %></title>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <%
    fonts = [@brand_setting.effective_font_primary, @brand_setting.effective_font_display].compact.uniq
    font_query = fonts.map { |f| "family=#{ERB::Util.url_encode(f)}:wght@300;400;500;600;700" }.join('&')
  %>
  <link href="https://fonts.googleapis.com/css2?<%= font_query %>&display=swap" rel="stylesheet">

  <!-- Brand Theme CSS Variables -->
  <%= @brand_setting.to_style_tag.html_safe %>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: var(--font-primary);
      line-height: 1.6;
      color: #1f2937;
      background: #f3f4f6;
    }

    .preview-header {
      background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
      color: white;
      padding: 40px 20px;
      text-align: center;
    }

    .preview-header h1 {
      font-family: var(--font-display);
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .preview-header p {
      font-size: 1.1rem;
      opacity: 0.9;
    }

    .preview-nav {
      background: var(--color-primary-dark);
      padding: 15px 20px;
      display: flex;
      gap: 20px;
      justify-content: center;
    }

    .preview-nav a {
      color: white;
      text-decoration: none;
      padding: 8px 16px;
      border-radius: 4px;
      transition: background 0.2s;
    }

    .preview-nav a:hover {
      background: rgba(255,255,255,0.1);
    }

    .preview-nav a.active {
      background: var(--color-secondary);
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
    }

    .section {
      background: white;
      border-radius: 12px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .section-title {
      font-family: var(--font-display);
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--color-primary);
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid var(--color-primary-light);
    }

    /* Color Palette */
    .color-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 20px;
    }

    .color-swatch {
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .color-swatch-preview {
      height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-family: monospace;
      font-size: 13px;
      font-weight: 600;
    }

    .color-swatch-label {
      padding: 12px;
      background: white;
      font-size: 13px;
      font-weight: 500;
      text-align: center;
    }

    /* Typography */
    .typography-sample h1 {
      font-family: var(--font-display);
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--color-primary);
      margin-bottom: 15px;
    }

    .typography-sample h2 {
      font-family: var(--font-display);
      font-size: 2rem;
      font-weight: 600;
      color: var(--color-primary-dark);
      margin-bottom: 15px;
    }

    .typography-sample h3 {
      font-family: var(--font-display);
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 15px;
    }

    .typography-sample p {
      margin-bottom: 15px;
      color: #4b5563;
    }

    .typography-sample .lead {
      font-size: 1.25rem;
      color: #6b7280;
    }

    /* Buttons */
    .button-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 20px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 500;
      font-size: 14px;
      text-decoration: none;
      border: none;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-primary {
      background: var(--color-primary);
      color: white;
    }

    .btn-primary:hover {
      background: var(--color-primary-dark);
    }

    .btn-secondary {
      background: var(--color-secondary);
      color: white;
    }

    .btn-secondary:hover {
      background: var(--color-secondary-dark);
    }

    .btn-outline {
      background: transparent;
      color: var(--color-primary);
      border: 2px solid var(--color-primary);
    }

    .btn-outline:hover {
      background: var(--color-primary);
      color: white;
    }

    .btn-ghost {
      background: transparent;
      color: var(--color-secondary);
      border: 2px solid var(--color-secondary);
    }

    .btn-ghost:hover {
      background: var(--color-secondary);
      color: white;
    }

    /* Form Elements */
    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      font-weight: 500;
      margin-bottom: 8px;
      color: #374151;
    }

    .form-input {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.2s;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px var(--color-primary-light);
    }

    /* Cards */
    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
    }

    .card {
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }

    .card-header {
      background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-light) 100%);
      color: white;
      padding: 20px;
    }

    .card-header h4 {
      font-family: var(--font-display);
      font-size: 1.25rem;
      font-weight: 600;
    }

    .card-body {
      padding: 20px;
      background: white;
    }

    .card-body p {
      color: #6b7280;
      font-size: 14px;
      margin-bottom: 15px;
    }

    /* Logo Preview */
    .logo-preview-section {
      display: flex;
      gap: 40px;
      flex-wrap: wrap;
    }

    .logo-box {
      padding: 30px;
      border-radius: 8px;
      min-width: 200px;
      text-align: center;
    }

    .logo-box.light {
      background: #f9fafb;
      border: 1px solid #e5e7eb;
    }

    .logo-box.dark {
      background: #1f2937;
    }

    .logo-box img {
      max-height: 60px;
      max-width: 200px;
    }

    .logo-box p {
      margin-top: 10px;
      font-size: 12px;
      color: #9ca3af;
    }

    /* Footer */
    .preview-footer {
      background: var(--color-primary-dark);
      color: white;
      padding: 40px 20px;
      text-align: center;
    }

    .preview-footer p {
      opacity: 0.8;
    }

    /* Back to Admin Link */
    .back-link {
      position: fixed;
      top: 20px;
      right: 20px;
      background: white;
      color: var(--color-primary);
      padding: 10px 20px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 500;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 1000;
    }

    .back-link:hover {
      background: var(--color-primary);
      color: white;
    }

    /* Alert/Badge Examples */
    .badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
    }

    .badge-primary {
      background: var(--color-primary-light);
      color: white;
    }

    .badge-secondary {
      background: var(--color-secondary-light);
      color: white;
    }

    .alert {
      padding: 16px 20px;
      border-radius: 8px;
      margin-bottom: 15px;
    }

    .alert-primary {
      background: color-mix(in srgb, var(--color-primary) 10%, white);
      border-left: 4px solid var(--color-primary);
      color: var(--color-primary-dark);
    }

    .alert-secondary {
      background: color-mix(in srgb, var(--color-secondary) 10%, white);
      border-left: 4px solid var(--color-secondary);
      color: var(--color-secondary-dark);
    }

    /* Theme Info Box */
    .theme-info {
      background: linear-gradient(135deg, var(--color-secondary) 0%, var(--color-secondary-dark) 100%);
      color: white;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .theme-info h3 {
      font-family: var(--font-display);
      margin-bottom: 10px;
    }

    .theme-info code {
      background: rgba(255,255,255,0.2);
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <a href="<%= admin_brand_setting_path(@brand_setting) %>" class="back-link">
    &larr; Back to Admin
  </a>

  <!-- Header -->
  <header class="preview-header">
    <% if @brand_setting.logo_url.present? %>
      <img src="<%= @brand_setting.logo_url %>" alt="Logo" style="max-height: 60px; margin-bottom: 20px;">
    <% end %>
    <h1><%= @brand_setting.name %></h1>
    <p>Theme Preview - <%= @brand_setting.theme_name || @brand_setting.predefined_theme_name %></p>
  </header>

  <!-- Navigation Example -->
  <nav class="preview-nav">
    <a href="#" class="active">Home</a>
    <a href="#">Features</a>
    <a href="#">Pricing</a>
    <a href="#">About</a>
    <a href="#">Contact</a>
  </nav>

  <div class="container">
    <!-- Theme Info -->
    <div class="theme-info">
      <h3>Theme Configuration</h3>
      <p>
        <strong>Theme ID:</strong> <code><%= @brand_setting.theme_id %></code> |
        <strong>Primary Font:</strong> <code><%= @brand_setting.effective_font_primary %></code> |
        <strong>Display Font:</strong> <code><%= @brand_setting.effective_font_display %></code> |
        <strong>Version:</strong> <code>v<%= @brand_setting.version %></code>
      </p>
    </div>

    <!-- Color Palette -->
    <section class="section">
      <h2 class="section-title">Color Palette</h2>
      <div class="color-grid">
        <% colors = @brand_setting.theme_colors %>
        <div class="color-swatch">
          <div class="color-swatch-preview" style="background-color: <%= colors[:primary] %>;">
            <%= colors[:primary] %>
          </div>
          <div class="color-swatch-label">Primary</div>
        </div>
        <div class="color-swatch">
          <div class="color-swatch-preview" style="background-color: <%= colors[:primaryLight] %>;">
            <%= colors[:primaryLight] %>
          </div>
          <div class="color-swatch-label">Primary Light</div>
        </div>
        <div class="color-swatch">
          <div class="color-swatch-preview" style="background-color: <%= colors[:primaryDark] %>;">
            <%= colors[:primaryDark] %>
          </div>
          <div class="color-swatch-label">Primary Dark</div>
        </div>
        <div class="color-swatch">
          <div class="color-swatch-preview" style="background-color: <%= colors[:secondary] %>;">
            <%= colors[:secondary] %>
          </div>
          <div class="color-swatch-label">Secondary</div>
        </div>
        <div class="color-swatch">
          <div class="color-swatch-preview" style="background-color: <%= colors[:secondaryLight] %>;">
            <%= colors[:secondaryLight] %>
          </div>
          <div class="color-swatch-label">Secondary Light</div>
        </div>
        <div class="color-swatch">
          <div class="color-swatch-preview" style="background-color: <%= colors[:secondaryDark] %>;">
            <%= colors[:secondaryDark] %>
          </div>
          <div class="color-swatch-label">Secondary Dark</div>
        </div>
      </div>
    </section>

    <!-- Typography -->
    <section class="section">
      <h2 class="section-title">Typography</h2>
      <div class="typography-sample">
        <h1>Heading 1 - <%= @brand_setting.effective_font_display %></h1>
        <h2>Heading 2 - Display Font</h2>
        <h3>Heading 3 - Subheading</h3>
        <p class="lead">This is a lead paragraph using the primary font (<%= @brand_setting.effective_font_primary %>). It's slightly larger and lighter to draw attention.</p>
        <p>This is a regular body paragraph. The quick brown fox jumps over the lazy dog. Typography is the art and technique of arranging type to make written language legible, readable and appealing when displayed.</p>
        <p><strong>Bold text</strong> | <em>Italic text</em> | <a href="#">Link example</a></p>
      </div>
    </section>

    <!-- Buttons -->
    <section class="section">
      <h2 class="section-title">Buttons</h2>
      <div class="button-grid">
        <button class="btn btn-primary">Primary Button</button>
        <button class="btn btn-secondary">Secondary Button</button>
        <button class="btn btn-outline">Outline Button</button>
        <button class="btn btn-ghost">Ghost Button</button>
      </div>
      <div class="button-grid">
        <span class="badge badge-primary">Primary Badge</span>
        <span class="badge badge-secondary">Secondary Badge</span>
      </div>
    </section>

    <!-- Alerts -->
    <section class="section">
      <h2 class="section-title">Alerts & Notifications</h2>
      <div class="alert alert-primary">
        <strong>Primary Alert:</strong> This is an important message using the primary color theme.
      </div>
      <div class="alert alert-secondary">
        <strong>Secondary Alert:</strong> This is a secondary notification with the accent color.
      </div>
    </section>

    <!-- Form Elements -->
    <section class="section">
      <h2 class="section-title">Form Elements</h2>
      <div style="max-width: 500px;">
        <div class="form-group">
          <label class="form-label">Email Address</label>
          <input type="email" class="form-input" placeholder="you@example.com">
        </div>
        <div class="form-group">
          <label class="form-label">Password</label>
          <input type="password" class="form-input" placeholder="Enter your password">
        </div>
        <button class="btn btn-primary">Sign In</button>
      </div>
    </section>

    <!-- Cards -->
    <section class="section">
      <h2 class="section-title">Cards</h2>
      <div class="card-grid">
        <div class="card">
          <div class="card-header">
            <h4>Feature One</h4>
          </div>
          <div class="card-body">
            <p>This card demonstrates how the theme colors are applied to card components and interactive elements.</p>
            <button class="btn btn-primary">Learn More</button>
          </div>
        </div>
        <div class="card">
          <div class="card-header" style="background: linear-gradient(135deg, var(--color-secondary) 0%, var(--color-secondary-dark) 100%);">
            <h4>Feature Two</h4>
          </div>
          <div class="card-body">
            <p>Cards using the secondary color scheme for variety and visual hierarchy in the interface.</p>
            <button class="btn btn-secondary">Explore</button>
          </div>
        </div>
        <div class="card">
          <div class="card-header">
            <h4>Feature Three</h4>
          </div>
          <div class="card-body">
            <p>Consistent styling across all components ensures a cohesive brand experience throughout.</p>
            <button class="btn btn-outline">View Details</button>
          </div>
        </div>
      </div>
    </section>

    <% if @brand_setting.logo_url.present? || @brand_setting.logo_dark_url.present? %>
    <!-- Logo Preview -->
    <section class="section">
      <h2 class="section-title">Logo Variants</h2>
      <div class="logo-preview-section">
        <% if @brand_setting.logo_url.present? %>
        <div class="logo-box light">
          <img src="<%= @brand_setting.logo_url %>" alt="Logo (Light Background)">
          <p>Light Background</p>
        </div>
        <% end %>
        <% if @brand_setting.logo_dark_url.present? %>
        <div class="logo-box dark">
          <img src="<%= @brand_setting.logo_dark_url %>" alt="Logo (Dark Background)">
          <p style="color: #9ca3af;">Dark Background</p>
        </div>
        <% end %>
      </div>
    </section>
    <% end %>

    <% if @brand_setting.custom_css.present? %>
    <!-- Custom CSS Info -->
    <section class="section">
      <h2 class="section-title">Custom CSS Applied</h2>
      <p style="color: #6b7280; margin-bottom: 15px;">This theme includes custom CSS rules that may affect additional elements.</p>
      <pre style="background: #f3f4f6; padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 13px;"><%= @brand_setting.sanitized_custom_css %></pre>
    </section>
    <% end %>
  </div>

  <!-- Footer -->
  <footer class="preview-footer">
    <p>&copy; <%= Time.current.year %> Theme Preview - <%= @brand_setting.name %></p>
    <p style="margin-top: 10px; font-size: 13px;">Generated from Brand Settings v<%= @brand_setting.version %></p>
  </footer>
</body>
</html>
